<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N0Y2LBMRSW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-N0Y2LBMRSW');
    </script>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="96x96" href="favicon-96.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    
    <!-- Primary Meta Tags -->
    <title>FREE DCA Calculator 2026 - Dollar Cost Averaging Bitcoin & Crypto | BroBillionaire</title>
    <meta name="title" content="FREE DCA Calculator - Dollar Cost Averaging 2026">
    <meta name="description" content="üî• FREE DCA Calculator with LIVE crypto prices! Calculate Dollar Cost Averaging returns for Bitcoin, Ethereum & 100+ cryptos. See historical DCA performance instantly!">
    <meta name="keywords" content="dca calculator, dollar cost averaging calculator, bitcoin dca, ethereum dca, crypto dca calculator, btc dca, investment calculator, recurring buy calculator, dca strategy, accumulation calculator">
    <meta name="author" content="BroBillionaire">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <link rel="canonical" href="https://brobillionaire.com/tool-dca-calculator.html">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://brobillionaire.com/tool-dca-calculator.html">
    <meta property="og:title" content="FREE DCA Calculator 2026 - Live Crypto Prices">
    <meta property="og:description" content="Calculate DCA returns with live crypto prices! See what if you invested weekly/monthly.">
    <meta property="og:image" content="https://brobillionaire.com/og-image.jpg">
    <meta property="og:site_name" content="BroBillionaire">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://brobillionaire.com/tool-dca-calculator.html">
    <meta name="twitter:title" content="FREE DCA Calculator - Live Prices">
    <meta name="twitter:description" content="Dollar Cost Averaging calculator with real-time crypto prices!">
    <meta name="twitter:image" content="https://brobillionaire.com/og-image.jpg">
    
    <!-- WebApplication Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "DCA Calculator - BroBillionaire",
        "description": "Free Dollar Cost Averaging calculator with live cryptocurrency prices for Bitcoin, Ethereum and 100+ cryptos",
        "url": "https://brobillionaire.com/tool-dca-calculator.html",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "INR"
        }
    }
    </script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%); color: #e0e0e0; line-height: 1.6; min-height: 100vh; }
        .container { max-width: 1400px; margin: 0 auto; padding: 1.5rem; }
        
        .premium-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: linear-gradient(135deg, #C9A227 0%, #ffd700 100%); color: #000; padding: 0.5rem 1rem; border-radius: 50px; font-weight: 700; font-size: 0.85rem; margin-bottom: 1rem; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        
        .header { text-align: center; padding: 2rem 1.5rem; background: linear-gradient(135deg, #1e1e2f 0%, #2a2a4a 100%); border-radius: 20px; margin-bottom: 1.5rem; border: 2px solid #C9A227; position: relative; overflow: hidden; }
        .header::before { content: 'üí∞'; position: absolute; top: 10px; right: 20px; font-size: 4rem; opacity: 0.1; }
        .header h1 { font-size: 2.5rem; background: linear-gradient(135deg, #C9A227 0%, #ffd700 50%, #C9A227 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.5rem; }
        .header p { font-size: 1.1rem; color: #a0a0b0; }
        
        .live-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(16, 185, 129, 0.2); color: #10b981; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; margin-top: 0.5rem; }
        .live-dot { width: 8px; height: 8px; background: #10b981; border-radius: 50%; animation: livePulse 1.5s infinite; }
        @keyframes livePulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        
        /* Layout */
        .main-grid { display: grid; grid-template-columns: 400px 1fr; gap: 1.5rem; }
        
        /* Input Section */
        .input-section { background: linear-gradient(135deg, #1e1e2f 0%, #16161f 100%); border-radius: 20px; padding: 1.5rem; border: 1px solid #333; position: sticky; top: 1.5rem; }
        .section-title { color: #C9A227; font-size: 1.2rem; font-weight: 600; margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.5rem; }
        
        .form-group { margin-bottom: 1.2rem; }
        .form-label { display: block; color: #888; font-size: 0.9rem; margin-bottom: 0.5rem; }
        .form-input { width: 100%; padding: 1rem; background: #16161f; border: 2px solid #333; border-radius: 12px; color: #fff; font-size: 1rem; transition: all 0.3s; }
        .form-input:focus { border-color: #C9A227; outline: none; box-shadow: 0 0 20px rgba(201, 162, 39, 0.2); }
        
        .asset-selector { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.5rem; margin-bottom: 1rem; }
        .asset-btn { padding: 0.8rem; background: #16161f; border: 2px solid #333; border-radius: 10px; cursor: pointer; text-align: center; transition: all 0.3s; }
        .asset-btn:hover { border-color: #C9A227; }
        .asset-btn.active { border-color: #C9A227; background: rgba(201, 162, 39, 0.1); }
        .asset-btn-icon { font-size: 1.5rem; margin-bottom: 0.3rem; }
        .asset-btn-name { font-size: 0.75rem; color: #888; }
        
        .frequency-btns { display: flex; gap: 0.5rem; }
        .freq-btn { flex: 1; padding: 0.8rem; background: #16161f; border: 2px solid #333; border-radius: 10px; color: #888; cursor: pointer; text-align: center; transition: all 0.3s; }
        .freq-btn:hover { border-color: #C9A227; color: #fff; }
        .freq-btn.active { background: linear-gradient(135deg, #C9A227, #a68b1e); color: #000; border-color: #C9A227; font-weight: 600; }
        
        .calculate-btn { width: 100%; background: linear-gradient(135deg, #C9A227, #a68b1e); color: #000; border: none; padding: 1.2rem; border-radius: 12px; font-weight: 700; font-size: 1.1rem; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; justify-content: center; gap: 0.5rem; margin-top: 1rem; }
        .calculate-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(201, 162, 39, 0.3); }
        .calculate-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        
        /* Current Price Card */
        .current-price { background: #16161f; border-radius: 12px; padding: 1rem; margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center; }
        .price-info h3 { font-size: 1.3rem; color: #fff; }
        .price-info span { font-size: 0.9rem; color: #888; }
        .price-change { padding: 0.4rem 0.8rem; border-radius: 20px; font-weight: 600; font-size: 0.9rem; }
        .price-change.positive { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .price-change.negative { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        
        /* Results Section */
        .results-section { display: flex; flex-direction: column; gap: 1.5rem; }
        
        /* Summary Cards */
        .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; }
        .summary-card { background: linear-gradient(135deg, #1e1e2f 0%, #16161f 100%); border-radius: 15px; padding: 1.5rem; text-align: center; border: 1px solid #333; transition: all 0.3s; }
        .summary-card:hover { border-color: #C9A227; transform: translateY(-3px); }
        .summary-card.highlight { border: 2px solid #C9A227; background: linear-gradient(135deg, #1e1e2f 0%, #2a2a4a 100%); }
        .summary-icon { font-size: 2rem; margin-bottom: 0.5rem; }
        .summary-value { font-size: 1.8rem; font-weight: 800; margin-bottom: 0.3rem; }
        .summary-value.profit { color: #22c55e; }
        .summary-value.loss { color: #ef4444; }
        .summary-label { color: #888; font-size: 0.9rem; }
        .summary-sub { color: #666; font-size: 0.8rem; margin-top: 0.3rem; }
        
        /* Growth Chart */
        .chart-card { background: linear-gradient(135deg, #1e1e2f 0%, #16161f 100%); border-radius: 15px; padding: 1.5rem; border: 1px solid #333; }
        .chart-title { color: #C9A227; font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center; }
        .chart-legend { display: flex; gap: 1rem; font-size: 0.85rem; }
        .legend-item { display: flex; align-items: center; gap: 0.3rem; color: #888; }
        .legend-dot { width: 10px; height: 10px; border-radius: 50%; }
        
        .chart-container { height: 300px; background: #16161f; border-radius: 10px; position: relative; overflow: hidden; }
        .chart-area { position: absolute; bottom: 0; left: 0; right: 0; top: 0; padding: 20px; }
        .chart-line { fill: none; stroke-width: 3; stroke-linecap: round; stroke-linejoin: round; }
        .chart-area-fill { opacity: 0.2; }
        .chart-grid-line { stroke: #2a2a4a; stroke-dasharray: 5, 5; }
        .chart-point { fill: #C9A227; }
        
        /* DCA Schedule */
        .schedule-card { background: linear-gradient(135deg, #1e1e2f 0%, #16161f 100%); border-radius: 15px; padding: 1.5rem; border: 1px solid #333; }
        .schedule-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .schedule-stats { display: flex; gap: 2rem; font-size: 0.9rem; color: #888; }
        .schedule-stats span { color: #C9A227; font-weight: 600; }
        
        .schedule-table { width: 100%; max-height: 300px; overflow-y: auto; }
        .schedule-table table { width: 100%; border-collapse: collapse; }
        .schedule-table th { text-align: left; padding: 0.8rem; color: #888; font-weight: 600; font-size: 0.85rem; border-bottom: 1px solid #333; position: sticky; top: 0; background: #1e1e2f; }
        .schedule-table td { padding: 0.8rem; border-bottom: 1px solid #2a2a4a; font-size: 0.9rem; }
        .schedule-table tr:hover { background: rgba(201, 162, 39, 0.05); }
        .amount-positive { color: #22c55e; }
        .amount-negative { color: #ef4444; }
        
        /* AI Insights */
        .ai-insights { background: linear-gradient(135deg, #1e1e2f 0%, #2a2a4a 100%); border-radius: 15px; padding: 1.5rem; border: 2px solid #C9A227; position: relative; }
        .ai-insights::before { content: 'üß†'; position: absolute; top: 1rem; right: 1rem; font-size: 2rem; opacity: 0.2; }
        .ai-title { font-size: 1.1rem; color: #C9A227; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; }
        .ai-content { color: #d0d0e0; font-size: 0.95rem; line-height: 1.8; }
        .ai-tips { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 1rem; }
        .ai-tip { padding: 0.4rem 1rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; }
        .ai-tip.success { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .ai-tip.warning { background: rgba(251, 191, 36, 0.2); color: #fbbf24; }
        .ai-tip.info { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        
        /* Comparison Section */
        .comparison { background: linear-gradient(135deg, #1e1e2f 0%, #16161f 100%); border-radius: 15px; padding: 1.5rem; border: 1px solid #333; }
        .comparison-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin-top: 1rem; }
        .compare-card { background: #16161f; border-radius: 10px; padding: 1rem; text-align: center; }
        .compare-card h4 { font-size: 0.9rem; color: #888; margin-bottom: 0.5rem; }
        .compare-value { font-size: 1.3rem; font-weight: 700; }
        .compare-value.best { color: #22c55e; }
        .compare-sub { font-size: 0.8rem; color: #666; margin-top: 0.3rem; }
        
        /* Responsive */
        @media (max-width: 1000px) {
            .main-grid { grid-template-columns: 1fr; }
            .input-section { position: static; }
            .summary-grid { grid-template-columns: repeat(2, 1fr); }
        }
        @media (max-width: 600px) {
            .header h1 { font-size: 1.8rem; }
            .asset-selector { grid-template-columns: repeat(2, 1fr); }
            .summary-grid { grid-template-columns: 1fr; }
            .comparison-grid { grid-template-columns: 1fr; }
        }
        
        /* Skeleton */
        .skeleton { background: linear-gradient(90deg, #2a2a4a 0%, #3a3a5a 50%, #2a2a4a 100%); background-size: 200% 100%; animation: shimmer 1.5s infinite; border-radius: 8px; }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="premium-badge">‚ö° LIVE CRYPTO PRICES - 100% FREE</div>
            <h1>üí∞ DCA Calculator</h1>
            <p>Dollar Cost Averaging ‚Ä¢ Historical Returns ‚Ä¢ Investment Strategy Simulator</p>
            <div class="live-badge">
                <span class="live-dot"></span>
                Real-Time Prices via CoinGecko
            </div>
        </div>

        <div class="main-grid">
            <!-- Input Section -->
            <div class="input-section">
                <div class="section-title">‚öôÔ∏è DCA Settings</div>
                
                <!-- Asset Selection -->
                <div class="form-group">
                    <label class="form-label">Select Asset</label>
                    <div class="asset-selector">
                        <div class="asset-btn active" data-id="bitcoin">
                            <div class="asset-btn-icon">‚Çø</div>
                            <div class="asset-btn-name">Bitcoin</div>
                        </div>
                        <div class="asset-btn" data-id="ethereum">
                            <div class="asset-btn-icon">Œû</div>
                            <div class="asset-btn-name">Ethereum</div>
                        </div>
                        <div class="asset-btn" data-id="solana">
                            <div class="asset-btn-icon">‚óé</div>
                            <div class="asset-btn-name">Solana</div>
                        </div>
                        <div class="asset-btn" data-id="cardano">
                            <div class="asset-btn-icon">‚Ç≥</div>
                            <div class="asset-btn-name">Cardano</div>
                        </div>
                        <div class="asset-btn" data-id="ripple">
                            <div class="asset-btn-icon">‚úï</div>
                            <div class="asset-btn-name">XRP</div>
                        </div>
                        <div class="asset-btn" data-id="dogecoin">
                            <div class="asset-btn-icon">√ê</div>
                            <div class="asset-btn-name">Dogecoin</div>
                        </div>
                    </div>
                    
                    <select class="form-input" id="assetSelect">
                        <option value="bitcoin">Bitcoin (BTC)</option>
                        <option value="ethereum">Ethereum (ETH)</option>
                        <option value="solana">Solana (SOL)</option>
                        <option value="cardano">Cardano (ADA)</option>
                        <option value="ripple">XRP (XRP)</option>
                        <option value="dogecoin">Dogecoin (DOGE)</option>
                        <option value="polkadot">Polkadot (DOT)</option>
                        <option value="avalanche-2">Avalanche (AVAX)</option>
                        <option value="chainlink">Chainlink (LINK)</option>
                        <option value="uniswap">Uniswap (UNI)</option>
                        <option value="litecoin">Litecoin (LTC)</option>
                        <option value="matic-network">Polygon (MATIC)</option>
                    </select>
                </div>

                <!-- Current Price -->
                <div class="current-price">
                    <div class="price-info">
                        <h3 id="currentPrice">$--</h3>
                        <span>Current Price</span>
                    </div>
                    <div class="price-change positive" id="priceChange">+0%</div>
                </div>
                
                <!-- Investment Amount -->
                <div class="form-group">
                    <label class="form-label">Investment Amount (per period)</label>
                    <input type="number" class="form-input" id="investmentAmount" value="100" placeholder="e.g., 100">
                </div>
                
                <!-- Frequency -->
                <div class="form-group">
                    <label class="form-label">Frequency</label>
                    <div class="frequency-btns">
                        <button class="freq-btn" data-freq="daily">Daily</button>
                        <button class="freq-btn active" data-freq="weekly">Weekly</button>
                        <button class="freq-btn" data-freq="biweekly">Bi-Weekly</button>
                        <button class="freq-btn" data-freq="monthly">Monthly</button>
                    </div>
                </div>
                
                <!-- Duration -->
                <div class="form-group">
                    <label class="form-label">Investment Period</label>
                    <select class="form-input" id="duration">
                        <option value="3">3 Months</option>
                        <option value="6">6 Months</option>
                        <option value="12" selected>1 Year</option>
                        <option value="24">2 Years</option>
                        <option value="36">3 Years</option>
                        <option value="60">5 Years</option>
                    </select>
                </div>
                
                <button class="calculate-btn" id="calculateBtn" onclick="calculateDCA()">
                    <span>üìä</span> Calculate DCA Returns
                </button>
            </div>

            <!-- Results Section -->
            <div class="results-section">
                <!-- Summary Cards -->
                <div class="summary-grid">
                    <div class="summary-card highlight">
                        <div class="summary-icon">üíé</div>
                        <div class="summary-value" id="totalValue">$0</div>
                        <div class="summary-label">Current Value</div>
                        <div class="summary-sub" id="totalHoldings">0 coins</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-icon">üíµ</div>
                        <div class="summary-value" id="totalInvested">$0</div>
                        <div class="summary-label">Total Invested</div>
                        <div class="summary-sub" id="purchaseCount">0 purchases</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-icon">üìà</div>
                        <div class="summary-value profit" id="totalProfit">$0</div>
                        <div class="summary-label">Profit/Loss</div>
                        <div class="summary-sub" id="profitPercent">0% ROI</div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-icon">üí≤</div>
                        <div class="summary-value" id="avgPrice">$0</div>
                        <div class="summary-label">Average Cost</div>
                        <div class="summary-sub" id="vsCurrent">vs current price</div>
                    </div>
                </div>

                <!-- Growth Chart -->
                <div class="chart-card">
                    <div class="chart-title">
                        üìä Portfolio Growth Over Time
                        <div class="chart-legend">
                            <span class="legend-item"><span class="legend-dot" style="background: #C9A227;"></span> Value</span>
                            <span class="legend-item"><span class="legend-dot" style="background: #4CAF50;"></span> Invested</span>
                        </div>
                    </div>
                    <div class="chart-container">
                        <svg id="growthChart" width="100%" height="100%" viewBox="0 0 800 260" preserveAspectRatio="none">
                            <defs>
                                <linearGradient id="valueGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:#C9A227;stop-opacity:0.4"/>
                                    <stop offset="100%" style="stop-color:#C9A227;stop-opacity:0"/>
                                </linearGradient>
                            </defs>
                            <!-- Grid lines -->
                            <line x1="0" y1="65" x2="800" y2="65" class="chart-grid-line"/>
                            <line x1="0" y1="130" x2="800" y2="130" class="chart-grid-line"/>
                            <line x1="0" y1="195" x2="800" y2="195" class="chart-grid-line"/>
                            
                            <!-- Area fill -->
                            <path id="valueArea" class="chart-area-fill" fill="url(#valueGradient)"/>
                            
                            <!-- Lines -->
                            <path id="investedLine" class="chart-line" stroke="#4CAF50"/>
                            <path id="valueLine" class="chart-line" stroke="#C9A227"/>
                        </svg>
                    </div>
                </div>

                <!-- Comparison -->
                <div class="comparison">
                    <div class="section-title">üìä DCA vs Lump Sum Comparison</div>
                    <div class="comparison-grid">
                        <div class="compare-card">
                            <h4>DCA Strategy</h4>
                            <div class="compare-value" id="dcaReturn">$0</div>
                            <div class="compare-sub" id="dcaROI">0% ROI</div>
                        </div>
                        <div class="compare-card">
                            <h4>Lump Sum (Start)</h4>
                            <div class="compare-value" id="lumpSumStart">$0</div>
                            <div class="compare-sub" id="lumpStartROI">0% ROI</div>
                        </div>
                        <div class="compare-card">
                            <h4>Best Strategy</h4>
                            <div class="compare-value best" id="bestStrategy">--</div>
                            <div class="compare-sub" id="bestDiff">Difference: $0</div>
                        </div>
                    </div>
                </div>

                <!-- DCA Schedule -->
                <div class="schedule-card">
                    <div class="schedule-header">
                        <div class="section-title" style="margin-bottom: 0;">üìÖ Purchase History</div>
                        <div class="schedule-stats">
                            Total Purchases: <span id="numPurchases">0</span>
                        </div>
                    </div>
                    <div class="schedule-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Price</th>
                                    <th>Amount</th>
                                    <th>Coins</th>
                                    <th>Cumulative</th>
                                </tr>
                            </thead>
                            <tbody id="scheduleBody">
                                <tr><td colspan="5" style="text-align: center; color: #666;">Run calculation to see schedule</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- AI Insights -->
                <div class="ai-insights">
                    <div class="ai-title">üß† AI DCA Analysis</div>
                    <div class="ai-content" id="aiContent">
                        Configure your DCA settings and click "Calculate" to receive personalized AI insights about your investment strategy.
                    </div>
                    <div class="ai-tips" id="aiTips">
                        <span class="ai-tip info">Waiting for calculation...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // State
        let selectedAsset = 'bitcoin';
        let frequency = 'weekly';
        let priceHistory = [];
        let currentPrice = 0;
        let change24h = 0;

        // Initialize asset buttons
        document.querySelectorAll('.asset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.asset-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                selectedAsset = btn.dataset.id;
                document.getElementById('assetSelect').value = selectedAsset;
                fetchCurrentPrice();
            });
        });

        document.getElementById('assetSelect').addEventListener('change', (e) => {
            selectedAsset = e.target.value;
            document.querySelectorAll('.asset-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.id === selectedAsset);
            });
            fetchCurrentPrice();
        });

        // Frequency buttons
        document.querySelectorAll('.freq-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.freq-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                frequency = btn.dataset.freq;
            });
        });

        // Fetch current price
        async function fetchCurrentPrice() {
            try {
                const response = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${selectedAsset}&vs_currency=usd&include_24hr_change=true`);
                const data = await response.json();
                
                if (data[selectedAsset]) {
                    currentPrice = data[selectedAsset].usd;
                    change24h = data[selectedAsset].usd_24h_change || 0;
                    
                    document.getElementById('currentPrice').textContent = '$' + currentPrice.toLocaleString('en-US', { maximumFractionDigits: 2 });
                    
                    const changeEl = document.getElementById('priceChange');
                    changeEl.textContent = (change24h >= 0 ? '+' : '') + change24h.toFixed(2) + '%';
                    changeEl.className = 'price-change ' + (change24h >= 0 ? 'positive' : 'negative');
                }
            } catch (error) {
                console.error('Failed to fetch price:', error);
            }
        }

        // Fetch historical prices
        async function fetchHistoricalPrices(days) {
            try {
                const response = await fetch(`https://api.coingecko.com/api/v3/coins/${selectedAsset}/market_chart?vs_currency=usd&days=${days}&interval=daily`);
                const data = await response.json();
                return data.prices || [];
            } catch (error) {
                console.error('Failed to fetch historical prices:', error);
                return [];
            }
        }

        // Calculate DCA
        async function calculateDCA() {
            const btn = document.getElementById('calculateBtn');
            btn.disabled = true;
            btn.innerHTML = '<span>‚è≥</span> Calculating...';
            
            const amount = parseFloat(document.getElementById('investmentAmount').value) || 100;
            const months = parseInt(document.getElementById('duration').value);
            const days = months * 30;
            
            // Fetch historical data
            const historicalPrices = await fetchHistoricalPrices(days);
            
            if (historicalPrices.length === 0) {
                alert('Failed to fetch price data. Please try again.');
                btn.disabled = false;
                btn.innerHTML = '<span>üìä</span> Calculate DCA Returns';
                return;
            }
            
            // Determine purchase frequency
            let skipDays;
            switch (frequency) {
                case 'daily': skipDays = 1; break;
                case 'weekly': skipDays = 7; break;
                case 'biweekly': skipDays = 14; break;
                case 'monthly': skipDays = 30; break;
                default: skipDays = 7;
            }
            
            // Calculate DCA
            let totalCoins = 0;
            let totalInvested = 0;
            const purchases = [];
            let cumulativeCoins = 0;
            
            for (let i = 0; i < historicalPrices.length; i += skipDays) {
                const [timestamp, price] = historicalPrices[i];
                const coins = amount / price;
                totalCoins += coins;
                totalInvested += amount;
                cumulativeCoins += coins;
                
                purchases.push({
                    date: new Date(timestamp),
                    price,
                    amount,
                    coins,
                    cumulative: cumulativeCoins
                });
            }
            
            // Get current price for final calculation
            await fetchCurrentPrice();
            
            const currentValue = totalCoins * currentPrice;
            const profit = currentValue - totalInvested;
            const roi = ((currentValue / totalInvested) - 1) * 100;
            const avgPrice = totalInvested / totalCoins;
            
            // Update summary cards
            document.getElementById('totalValue').textContent = '$' + currentValue.toLocaleString('en-US', { maximumFractionDigits: 2 });
            document.getElementById('totalHoldings').textContent = totalCoins.toFixed(6) + ' coins';
            
            document.getElementById('totalInvested').textContent = '$' + totalInvested.toLocaleString('en-US', { maximumFractionDigits: 2 });
            document.getElementById('purchaseCount').textContent = purchases.length + ' purchases';
            
            const profitEl = document.getElementById('totalProfit');
            profitEl.textContent = (profit >= 0 ? '+$' : '-$') + Math.abs(profit).toLocaleString('en-US', { maximumFractionDigits: 2 });
            profitEl.className = 'summary-value ' + (profit >= 0 ? 'profit' : 'loss');
            
            document.getElementById('profitPercent').textContent = (roi >= 0 ? '+' : '') + roi.toFixed(2) + '% ROI';
            
            document.getElementById('avgPrice').textContent = '$' + avgPrice.toLocaleString('en-US', { maximumFractionDigits: 2 });
            const vsCurrentDiff = ((currentPrice - avgPrice) / avgPrice * 100).toFixed(1);
            document.getElementById('vsCurrent').textContent = (vsCurrentDiff >= 0 ? '+' : '') + vsCurrentDiff + '% vs current';
            
            // Calculate lump sum comparison
            const firstPrice = historicalPrices[0][1];
            const lumpSumCoins = totalInvested / firstPrice;
            const lumpSumValue = lumpSumCoins * currentPrice;
            const lumpSumROI = ((lumpSumValue / totalInvested) - 1) * 100;
            
            document.getElementById('dcaReturn').textContent = '$' + currentValue.toLocaleString('en-US', { maximumFractionDigits: 2 });
            document.getElementById('dcaROI').textContent = (roi >= 0 ? '+' : '') + roi.toFixed(2) + '% ROI';
            
            document.getElementById('lumpSumStart').textContent = '$' + lumpSumValue.toLocaleString('en-US', { maximumFractionDigits: 2 });
            document.getElementById('lumpStartROI').textContent = (lumpSumROI >= 0 ? '+' : '') + lumpSumROI.toFixed(2) + '% ROI';
            
            const bestEl = document.getElementById('bestStrategy');
            const diffEl = document.getElementById('bestDiff');
            if (currentValue > lumpSumValue) {
                bestEl.textContent = '‚úÖ DCA Wins!';
                diffEl.textContent = '+$' + (currentValue - lumpSumValue).toLocaleString('en-US', { maximumFractionDigits: 2 }) + ' better';
            } else {
                bestEl.textContent = 'üí∞ Lump Sum Wins';
                bestEl.style.color = '#fbbf24';
                diffEl.textContent = '+$' + (lumpSumValue - currentValue).toLocaleString('en-US', { maximumFractionDigits: 2 }) + ' better';
            }
            
            // Update chart
            updateChart(purchases, currentPrice);
            
            // Update schedule
            updateSchedule(purchases);
            
            // Generate AI insights
            generateAIInsights(purchases, roi, avgPrice, currentPrice, currentValue > lumpSumValue);
            
            btn.disabled = false;
            btn.innerHTML = '<span>üìä</span> Calculate DCA Returns';
        }

        function updateChart(purchases, finalPrice) {
            if (purchases.length < 2) return;
            
            const svg = document.getElementById('growthChart');
            const width = 800;
            const height = 260;
            const padding = 20;
            
            // Calculate values over time
            const dataPoints = [];
            let cumCoins = 0;
            let cumInvested = 0;
            
            purchases.forEach(p => {
                cumCoins += p.coins;
                cumInvested += p.amount;
                dataPoints.push({
                    invested: cumInvested,
                    value: cumCoins * finalPrice // Simplified - show final value projection
                });
            });
            
            const maxValue = Math.max(...dataPoints.map(d => Math.max(d.value, d.invested)));
            const minValue = 0;
            
            const xStep = (width - padding * 2) / (dataPoints.length - 1);
            const yScale = (val) => height - padding - ((val - minValue) / (maxValue - minValue)) * (height - padding * 2);
            
            // Build paths
            let valuePath = 'M';
            let investedPath = 'M';
            let areaPath = 'M';
            
            dataPoints.forEach((d, i) => {
                const x = padding + i * xStep;
                const yVal = yScale(d.value);
                const yInv = yScale(d.invested);
                
                if (i === 0) {
                    valuePath += `${x} ${yVal}`;
                    investedPath += `${x} ${yInv}`;
                    areaPath += `${x} ${yVal}`;
                } else {
                    valuePath += ` L ${x} ${yVal}`;
                    investedPath += ` L ${x} ${yInv}`;
                    areaPath += ` L ${x} ${yVal}`;
                }
            });
            
            // Close area path
            areaPath += ` L ${padding + (dataPoints.length - 1) * xStep} ${height - padding} L ${padding} ${height - padding} Z`;
            
            document.getElementById('valueLine').setAttribute('d', valuePath);
            document.getElementById('investedLine').setAttribute('d', investedPath);
            document.getElementById('valueArea').setAttribute('d', areaPath);
        }

        function updateSchedule(purchases) {
            const tbody = document.getElementById('scheduleBody');
            document.getElementById('numPurchases').textContent = purchases.length;
            
            // Show last 20 purchases
            const recentPurchases = purchases.slice(-20).reverse();
            
            tbody.innerHTML = recentPurchases.map(p => `
                <tr>
                    <td>${p.date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}</td>
                    <td>$${p.price.toLocaleString('en-US', { maximumFractionDigits: 2 })}</td>
                    <td>$${p.amount}</td>
                    <td>${p.coins.toFixed(6)}</td>
                    <td>${p.cumulative.toFixed(6)}</td>
                </tr>
            `).join('');
        }

        function generateAIInsights(purchases, roi, avgPrice, currentPrice, dcaWins) {
            const tips = [];
            let content = '';
            
            if (roi > 50) {
                content = `<strong>üöÄ Excellent Returns!</strong> Your DCA strategy has delivered ${roi.toFixed(1)}% ROI. By investing consistently, you've accumulated coins at an average price of $${avgPrice.toFixed(2)}, which is ${((currentPrice - avgPrice) / avgPrice * 100).toFixed(1)}% below current price. `;
                tips.push({ text: 'Strong Performance', class: 'success' });
            } else if (roi > 0) {
                content = `<strong>üìà Positive Returns!</strong> Your DCA strategy is working with ${roi.toFixed(1)}% ROI. You've successfully bought at various price levels, averaging $${avgPrice.toFixed(2)} per coin. `;
                tips.push({ text: 'On Track', class: 'success' });
            } else {
                content = `<strong>üìâ Temporary Drawdown.</strong> Your current ROI is ${roi.toFixed(1)}%. Remember, DCA is a long-term strategy. Your average price of $${avgPrice.toFixed(2)} may become profitable as the market recovers. `;
                tips.push({ text: 'Stay Patient', class: 'warning' });
            }
            
            if (dcaWins) {
                content += 'DCA outperformed lump sum in this period, demonstrating the power of buying through volatility. ';
                tips.push({ text: 'DCA > Lump Sum', class: 'success' });
            } else {
                content += 'Lump sum performed better this time, which is common in strong bull markets. DCA still reduces risk. ';
                tips.push({ text: 'Lower Risk Profile', class: 'info' });
            }
            
            content += `Total of ${purchases.length} purchases made over the investment period.`;
            tips.push({ text: 'Consistent Investing', class: 'info' });
            
            document.getElementById('aiContent').innerHTML = content;
            document.getElementById('aiTips').innerHTML = tips.map(t => 
                `<span class="ai-tip ${t.class}">${t.text}</span>`
            ).join('');
        }

        // Initialize
        fetchCurrentPrice();
    </script>
<script src="common-footer.js" defer></script>
</body>
</html>
