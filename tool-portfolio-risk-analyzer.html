<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-N0Y2LBMRSW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-N0Y2LBMRSW');
    </script>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="icon" type="image/png" sizes="96x96" href="favicon-96.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    
    <!-- Primary Meta Tags -->
    <title>FREE Portfolio Risk Analyzer 2026 - VaR, Sharpe Ratio, Drawdown | BroBillionaire</title>
    <meta name="title" content="FREE Portfolio Risk Analyzer - VaR & Risk Metrics 2026">
    <meta name="description" content="üî• FREE Portfolio Risk Analyzer - Calculate Value at Risk (VaR), Sharpe Ratio, Max Drawdown & more! AI-powered risk assessment for crypto, stocks & forex traders.">
    <meta name="keywords" content="portfolio risk analyzer, value at risk calculator, VaR calculator, sharpe ratio calculator, max drawdown calculator, portfolio risk metrics, crypto risk assessment, stock portfolio analysis, risk management tool, volatility calculator">
    <meta name="author" content="BroBillionaire">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <link rel="canonical" href="https://brobillionaire.com/tool-portfolio-risk-analyzer.html">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://brobillionaire.com/tool-portfolio-risk-analyzer.html">
    <meta property="og:title" content="FREE Portfolio Risk Analyzer 2026">
    <meta property="og:description" content="Calculate VaR, Sharpe Ratio, Max Drawdown & more. Professional risk metrics for traders.">
    <meta property="og:image" content="https://brobillionaire.com/og-image.jpg">
    <meta property="og:site_name" content="BroBillionaire">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://brobillionaire.com/tool-portfolio-risk-analyzer.html">
    <meta name="twitter:title" content="FREE Portfolio Risk Analyzer">
    <meta name="twitter:description" content="Professional risk metrics: VaR, Sharpe Ratio, Max Drawdown for traders.">
    <meta name="twitter:image" content="https://brobillionaire.com/og-image.jpg">
    
    <!-- WebApplication Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Portfolio Risk Analyzer - BroBillionaire",
        "description": "Free portfolio risk analyzer with Value at Risk (VaR), Sharpe Ratio, Max Drawdown calculations for crypto, stocks and forex",
        "url": "https://brobillionaire.com/tool-portfolio-risk-analyzer.html",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Any",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "INR"
        }
    }
    </script>

    <!-- BreadcrumbList Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://brobillionaire.com/"},
            {"@type": "ListItem", "position": 2, "name": "Tools", "item": "https://brobillionaire.com/tools.html"},
            {"@type": "ListItem", "position": 3, "name": "Portfolio Risk Analyzer"}
        ]
    }
    </script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%); color: #e0e0e0; line-height: 1.6; min-height: 100vh; }
        .container { max-width: 1400px; margin: 0 auto; padding: 1.5rem; }
        
        .premium-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: linear-gradient(135deg, #C9A227 0%, #ffd700 100%); color: #000; padding: 0.5rem 1rem; border-radius: 50px; font-weight: 700; font-size: 0.85rem; margin-bottom: 1rem; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        
        .header { text-align: center; padding: 2rem 1.5rem; background: linear-gradient(135deg, #1e1e2f 0%, #2a2a4a 100%); border-radius: 20px; margin-bottom: 1.5rem; border: 2px solid #C9A227; position: relative; overflow: hidden; }
        .header::before { content: '‚ö†Ô∏è'; position: absolute; top: 10px; right: 20px; font-size: 4rem; opacity: 0.1; }
        .header h1 { font-size: 2.5rem; background: linear-gradient(135deg, #C9A227 0%, #ffd700 50%, #C9A227 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.5rem; }
        .header p { font-size: 1.1rem; color: #a0a0b0; }
        
        .live-badge { display: inline-flex; align-items: center; gap: 0.5rem; background: rgba(16, 185, 129, 0.2); color: #10b981; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; margin-top: 0.5rem; }
        .live-dot { width: 8px; height: 8px; background: #10b981; border-radius: 50%; animation: livePulse 1.5s infinite; }
        @keyframes livePulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        
        /* Layout */
        .main-grid { display: grid; grid-template-columns: 1fr 1.5fr; gap: 1.5rem; }
        
        /* Portfolio Input Section */
        .input-section { background: linear-gradient(135deg, #1e1e2f 0%, #16161f 100%); border-radius: 20px; padding: 1.5rem; border: 1px solid #333; }
        .section-title { color: #C9A227; font-size: 1.2rem; font-weight: 600; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; }
        
        .portfolio-form { display: flex; flex-direction: column; gap: 1rem; }
        .form-group { display: flex; flex-direction: column; gap: 0.5rem; }
        .form-label { color: #888; font-size: 0.9rem; }
        .form-input { padding: 0.8rem 1rem; background: #16161f; border: 2px solid #333; border-radius: 10px; color: #fff; font-size: 1rem; transition: all 0.3s; }
        .form-input:focus { border-color: #C9A227; outline: none; }
        .form-input::placeholder { color: #555; }
        
        .asset-list { background: #16161f; border-radius: 10px; padding: 1rem; max-height: 300px; overflow-y: auto; }
        .asset-item { display: flex; justify-content: space-between; align-items: center; padding: 0.8rem; background: #1e1e2f; border-radius: 8px; margin-bottom: 0.5rem; border: 1px solid #333; }
        .asset-item:last-child { margin-bottom: 0; }
        .asset-info { display: flex; align-items: center; gap: 0.8rem; }
        .asset-icon { width: 32px; height: 32px; border-radius: 50%; background: #2a2a4a; display: flex; align-items: center; justify-content: center; font-size: 1rem; }
        .asset-name { font-weight: 600; font-size: 0.9rem; }
        .asset-symbol { color: #888; font-size: 0.8rem; }
        .asset-allocation { display: flex; align-items: center; gap: 0.5rem; }
        .allocation-input { width: 80px; padding: 0.5rem; background: #16161f; border: 1px solid #333; border-radius: 6px; color: #fff; text-align: center; }
        .remove-btn { background: rgba(239, 68, 68, 0.2); color: #ef4444; border: none; width: 28px; height: 28px; border-radius: 50%; cursor: pointer; font-size: 1rem; }
        
        .add-asset-row { display: flex; gap: 0.5rem; margin-top: 0.5rem; }
        .asset-select { flex: 1; padding: 0.8rem; background: #16161f; border: 2px solid #333; border-radius: 10px; color: #fff; font-size: 0.9rem; }
        .add-btn { background: linear-gradient(135deg, #C9A227, #a68b1e); color: #000; border: none; padding: 0.8rem 1.5rem; border-radius: 10px; font-weight: 600; cursor: pointer; }
        
        .analyze-btn { background: linear-gradient(135deg, #C9A227, #a68b1e); color: #000; border: none; padding: 1rem 2rem; border-radius: 10px; font-weight: 700; font-size: 1.1rem; cursor: pointer; transition: all 0.3s; margin-top: 1rem; display: flex; align-items: center; justify-content: center; gap: 0.5rem; }
        .analyze-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(201, 162, 39, 0.3); }
        .analyze-btn:disabled { opacity: 0.6; cursor: not-allowed; }
        
        /* Results Section */
        .results-section { display: flex; flex-direction: column; gap: 1.5rem; }
        
        /* Risk Score Card */
        .risk-score-card { background: linear-gradient(135deg, #1e1e2f 0%, #2a2a4a 100%); border-radius: 20px; padding: 2rem; border: 2px solid #C9A227; text-align: center; }
        .risk-score-gauge { position: relative; width: 220px; height: 110px; margin: 0 auto 1rem; }
        .risk-score-gauge svg { width: 100%; height: 100%; overflow: visible; }
        .gauge-bg { fill: none; stroke: #2a2a4a; stroke-width: 20; }
        .gauge-fill { fill: none; stroke-width: 20; stroke-linecap: round; transition: all 1s ease-out; }
        .risk-score-value { font-size: 3.5rem; font-weight: 800; }
        .risk-score-label { font-size: 1.2rem; font-weight: 600; margin-top: 0.3rem; }
        .risk-scale { display: flex; justify-content: space-between; max-width: 220px; margin: 0.5rem auto; color: #888; font-size: 0.75rem; }
        
        /* Metrics Grid */
        .metrics-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
        .metric-card { background: linear-gradient(135deg, #1e1e2f 0%, #16161f 100%); border-radius: 15px; padding: 1.2rem; border: 1px solid #333; text-align: center; transition: all 0.3s; }
        .metric-card:hover { border-color: #C9A227; }
        .metric-icon { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .metric-value { font-size: 1.5rem; font-weight: 800; margin-bottom: 0.3rem; }
        .metric-label { color: #888; font-size: 0.85rem; }
        .metric-change { font-size: 0.8rem; margin-top: 0.3rem; }
        .metric-change.positive { color: #22c55e; }
        .metric-change.negative { color: #ef4444; }
        
        /* Detailed Metrics */
        .details-section { background: linear-gradient(135deg, #1e1e2f 0%, #16161f 100%); border-radius: 15px; padding: 1.5rem; border: 1px solid #333; }
        .detail-row { display: flex; justify-content: space-between; align-items: center; padding: 0.8rem 0; border-bottom: 1px solid #2a2a4a; }
        .detail-row:last-child { border-bottom: none; }
        .detail-label { color: #888; font-size: 0.9rem; display: flex; align-items: center; gap: 0.5rem; }
        .detail-value { font-weight: 600; font-size: 1rem; }
        .tooltip { position: relative; cursor: help; }
        .tooltip::after { content: attr(data-tooltip); position: absolute; bottom: 125%; left: 50%; transform: translateX(-50%); background: #333; color: #fff; padding: 0.5rem 0.8rem; border-radius: 6px; font-size: 0.75rem; white-space: nowrap; opacity: 0; visibility: hidden; transition: all 0.3s; z-index: 100; }
        .tooltip:hover::after { opacity: 1; visibility: visible; }
        
        /* AI Insights */
        .ai-insights { background: linear-gradient(135deg, #1e1e2f 0%, #2a2a4a 100%); border-radius: 15px; padding: 1.5rem; border: 2px solid #C9A227; position: relative; margin-top: 1.5rem; }
        .ai-insights::before { content: 'üß†'; position: absolute; top: 1rem; right: 1rem; font-size: 2rem; opacity: 0.2; }
        .ai-title { font-size: 1.1rem; color: #C9A227; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; }
        .ai-content { color: #d0d0e0; font-size: 0.95rem; line-height: 1.8; }
        .ai-recommendations { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-top: 1rem; }
        .ai-rec { padding: 0.4rem 1rem; border-radius: 20px; font-size: 0.85rem; font-weight: 600; }
        .ai-rec.warning { background: rgba(251, 191, 36, 0.2); color: #fbbf24; }
        .ai-rec.danger { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .ai-rec.success { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        
        /* Charts */
        .charts-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-top: 1.5rem; }
        .chart-card { background: linear-gradient(135deg, #1e1e2f 0%, #16161f 100%); border-radius: 15px; padding: 1.5rem; border: 1px solid #333; }
        .chart-title { color: #C9A227; font-size: 1rem; font-weight: 600; margin-bottom: 1rem; }
        .pie-chart { width: 180px; height: 180px; margin: 0 auto; position: relative; }
        .pie-chart svg { width: 100%; height: 100%; transform: rotate(-90deg); }
        .pie-legend { display: flex; flex-direction: column; gap: 0.5rem; margin-top: 1rem; }
        .legend-item { display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; }
        .legend-color { width: 12px; height: 12px; border-radius: 3px; }
        
        .drawdown-chart { height: 150px; background: #16161f; border-radius: 10px; position: relative; overflow: hidden; }
        .drawdown-bars { display: flex; align-items: flex-end; height: 100%; padding: 1rem; gap: 4px; }
        .drawdown-bar { flex: 1; border-radius: 3px 3px 0 0; transition: all 0.3s; position: relative; }
        .drawdown-bar:hover { opacity: 0.8; }
        
        /* Responsive */
        @media (max-width: 1000px) {
            .main-grid { grid-template-columns: 1fr; }
            .charts-row { grid-template-columns: 1fr; }
        }
        @media (max-width: 600px) {
            .header h1 { font-size: 1.8rem; }
            .metrics-grid { grid-template-columns: 1fr; }
            .risk-score-value { font-size: 2.5rem; }
        }
        
        /* Skeleton */
        .skeleton { background: linear-gradient(90deg, #2a2a4a 0%, #3a3a5a 50%, #2a2a4a 100%); background-size: 200% 100%; animation: shimmer 1.5s infinite; border-radius: 8px; }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="premium-badge">‚ö° INSTITUTIONAL-GRADE RISK ANALYSIS - FREE</div>
            <h1>‚ö†Ô∏è Portfolio Risk Analyzer</h1>
            <p>Calculate VaR ‚Ä¢ Sharpe Ratio ‚Ä¢ Max Drawdown ‚Ä¢ AI Risk Assessment</p>
            <div class="live-badge">
                <span class="live-dot"></span>
                Real-Time Price Data
            </div>
        </div>

        <div class="main-grid">
            <!-- Input Section -->
            <div class="input-section">
                <div class="section-title">üìä Build Your Portfolio</div>
                
                <div class="portfolio-form">
                    <div class="form-group">
                        <label class="form-label">Portfolio Value ($)</label>
                        <input type="number" class="form-input" id="portfolioValue" value="10000" placeholder="Enter portfolio value">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Your Assets (Allocation %)</label>
                        <div class="asset-list" id="assetList">
                            <!-- Assets will be added here -->
                        </div>
                        
                        <div class="add-asset-row">
                            <select class="asset-select" id="assetSelect">
                                <option value="">Select asset to add...</option>
                                <optgroup label="Crypto">
                                    <option value="bitcoin">Bitcoin (BTC)</option>
                                    <option value="ethereum">Ethereum (ETH)</option>
                                    <option value="solana">Solana (SOL)</option>
                                    <option value="cardano">Cardano (ADA)</option>
                                    <option value="ripple">XRP (XRP)</option>
                                    <option value="dogecoin">Dogecoin (DOGE)</option>
                                    <option value="polkadot">Polkadot (DOT)</option>
                                    <option value="avalanche-2">Avalanche (AVAX)</option>
                                </optgroup>
                                <optgroup label="Simulated Stocks">
                                    <option value="stock-spy">S&P 500 ETF (SPY)</option>
                                    <option value="stock-qqq">NASDAQ ETF (QQQ)</option>
                                    <option value="stock-aapl">Apple (AAPL)</option>
                                    <option value="stock-msft">Microsoft (MSFT)</option>
                                    <option value="stock-nvda">NVIDIA (NVDA)</option>
                                </optgroup>
                                <optgroup label="Stable">
                                    <option value="tether">USDT (Tether)</option>
                                    <option value="usd-coin">USDC</option>
                                </optgroup>
                            </select>
                            <button class="add-btn" onclick="addAsset()">+ Add</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Time Horizon</label>
                        <select class="form-input" id="timeHorizon">
                            <option value="1">1 Day (Trading)</option>
                            <option value="7">7 Days (Weekly)</option>
                            <option value="30" selected>30 Days (Monthly)</option>
                            <option value="90">90 Days (Quarterly)</option>
                            <option value="365">365 Days (Yearly)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confidence Level (VaR)</label>
                        <select class="form-input" id="confidenceLevel">
                            <option value="0.90">90% Confidence</option>
                            <option value="0.95" selected>95% Confidence</option>
                            <option value="0.99">99% Confidence</option>
                        </select>
                    </div>
                    
                    <button class="analyze-btn" id="analyzeBtn" onclick="analyzeRisk()">
                        <span>üîç</span> Analyze Portfolio Risk
                    </button>
                </div>
            </div>

            <!-- Results Section -->
            <div class="results-section">
                <!-- Risk Score -->
                <div class="risk-score-card">
                    <div class="section-title" style="justify-content: center;">üìà Overall Risk Score</div>
                    <div class="risk-score-gauge">
                        <svg viewBox="0 0 200 110">
                            <defs>
                                <linearGradient id="riskGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:#22c55e"/>
                                    <stop offset="50%" style="stop-color:#fbbf24"/>
                                    <stop offset="100%" style="stop-color:#ef4444"/>
                                </linearGradient>
                            </defs>
                            <path class="gauge-bg" d="M20 100 A80 80 0 0 1 180 100"></path>
                            <path class="gauge-fill" id="riskGaugeFill" d="M20 100 A80 80 0 0 1 180 100" style="stroke: url(#riskGradient); stroke-dasharray: 251; stroke-dashoffset: 251;"></path>
                            <g id="riskNeedle" transform="rotate(-90, 100, 100)">
                                <line x1="100" y1="100" x2="100" y2="30" stroke="#C9A227" stroke-width="3" stroke-linecap="round"/>
                                <circle cx="100" cy="100" r="8" fill="#C9A227"/>
                            </g>
                        </svg>
                    </div>
                    <div class="risk-score-value" id="riskScoreValue">--</div>
                    <div class="risk-score-label" id="riskScoreLabel">Add assets to analyze</div>
                    <div class="risk-scale">
                        <span>Low Risk</span>
                        <span>Moderate</span>
                        <span>High Risk</span>
                    </div>
                </div>

                <!-- Key Metrics -->
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-icon">üìâ</div>
                        <div class="metric-value" id="varValue">--</div>
                        <div class="metric-label">Value at Risk (VaR)</div>
                        <div class="metric-change negative" id="varPercent">--% of portfolio</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">üìä</div>
                        <div class="metric-value" id="sharpeValue">--</div>
                        <div class="metric-label">Sharpe Ratio</div>
                        <div class="metric-change" id="sharpeRating">--</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">‚ö°</div>
                        <div class="metric-value" id="volatilityValue">--</div>
                        <div class="metric-label">Annualized Volatility</div>
                        <div class="metric-change" id="volatilityRating">--</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-icon">üìâ</div>
                        <div class="metric-value" id="drawdownValue">--</div>
                        <div class="metric-label">Max Drawdown</div>
                        <div class="metric-change negative" id="drawdownRating">--</div>
                    </div>
                </div>

                <!-- Detailed Metrics -->
                <div class="details-section">
                    <div class="section-title">üìã Detailed Risk Metrics</div>
                    <div class="detail-row">
                        <span class="detail-label">
                            <span class="tooltip" data-tooltip="Expected Shortfall is the average loss beyond VaR">Expected Shortfall (CVaR)</span>
                        </span>
                        <span class="detail-value" id="cvarValue">--</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">
                            <span class="tooltip" data-tooltip="Beta measures portfolio sensitivity to market movements">Portfolio Beta</span>
                        </span>
                        <span class="detail-value" id="betaValue">--</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">
                            <span class="tooltip" data-tooltip="Measures skewness of return distribution">Skewness</span>
                        </span>
                        <span class="detail-value" id="skewnessValue">--</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">
                            <span class="tooltip" data-tooltip="Measures tail risk - higher means more extreme moves">Kurtosis</span>
                        </span>
                        <span class="detail-value" id="kurtosisValue">--</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">
                            <span class="tooltip" data-tooltip="Average number of days to recover from drawdown">Recovery Time (Est.)</span>
                        </span>
                        <span class="detail-value" id="recoveryValue">--</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts -->
        <div class="charts-row">
            <div class="chart-card">
                <div class="chart-title">üìä Portfolio Allocation</div>
                <div class="pie-chart" id="pieChart">
                    <svg viewBox="0 0 100 100"></svg>
                </div>
                <div class="pie-legend" id="pieLegend"></div>
            </div>
            <div class="chart-card">
                <div class="chart-title">üìâ Historical Drawdown Simulation</div>
                <div class="drawdown-chart">
                    <div class="drawdown-bars" id="drawdownBars">
                        <!-- Bars will be generated -->
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Insights -->
        <div class="ai-insights">
            <div class="ai-title">üß† AI Risk Assessment</div>
            <div class="ai-content" id="aiContent">
                Add assets to your portfolio and click "Analyze" to receive AI-powered risk insights and recommendations.
            </div>
            <div class="ai-recommendations" id="aiRecommendations">
                <span class="ai-rec warning">Waiting for analysis...</span>
            </div>
        </div>
    </div>

    <script>
        // Portfolio state
        let portfolio = [];
        let priceData = {};
        
        // Asset metadata
        const assetMeta = {
            'bitcoin': { name: 'Bitcoin', symbol: 'BTC', icon: '‚Çø', color: '#f7931a', volatility: 0.75 },
            'ethereum': { name: 'Ethereum', symbol: 'ETH', icon: 'Œû', color: '#627eea', volatility: 0.80 },
            'solana': { name: 'Solana', symbol: 'SOL', icon: '‚óé', color: '#00ffa3', volatility: 0.95 },
            'cardano': { name: 'Cardano', symbol: 'ADA', icon: '‚Ç≥', color: '#0033ad', volatility: 0.85 },
            'ripple': { name: 'XRP', symbol: 'XRP', icon: '‚úï', color: '#23292f', volatility: 0.70 },
            'dogecoin': { name: 'Dogecoin', symbol: 'DOGE', icon: '√ê', color: '#c3a634', volatility: 1.10 },
            'polkadot': { name: 'Polkadot', symbol: 'DOT', icon: '‚óè', color: '#e6007a', volatility: 0.90 },
            'avalanche-2': { name: 'Avalanche', symbol: 'AVAX', icon: 'A', color: '#e84142', volatility: 0.95 },
            'tether': { name: 'Tether', symbol: 'USDT', icon: '$', color: '#26a17b', volatility: 0.01 },
            'usd-coin': { name: 'USDC', symbol: 'USDC', icon: '$', color: '#2775ca', volatility: 0.01 },
            'stock-spy': { name: 'S&P 500 ETF', symbol: 'SPY', icon: 'üìà', color: '#4CAF50', volatility: 0.18 },
            'stock-qqq': { name: 'NASDAQ ETF', symbol: 'QQQ', icon: 'üìä', color: '#2196F3', volatility: 0.25 },
            'stock-aapl': { name: 'Apple', symbol: 'AAPL', icon: 'üçé', color: '#999999', volatility: 0.28 },
            'stock-msft': { name: 'Microsoft', symbol: 'MSFT', icon: 'ü™ü', color: '#00a4ef', volatility: 0.26 },
            'stock-nvda': { name: 'NVIDIA', symbol: 'NVDA', icon: 'üéÆ', color: '#76b900', volatility: 0.45 }
        };

        // Fetch crypto prices
        async function fetchPrices() {
            const cryptoIds = portfolio.filter(p => !p.id.startsWith('stock-')).map(p => p.id);
            if (cryptoIds.length === 0) return;
            
            try {
                const response = await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${cryptoIds.join(',')}&vs_currency=usd&include_24hr_change=true`);
                const data = await response.json();
                
                for (const id of cryptoIds) {
                    if (data[id]) {
                        priceData[id] = {
                            price: data[id].usd,
                            change24h: data[id].usd_24h_change || 0
                        };
                    }
                }
            } catch (error) {
                console.error('Failed to fetch prices:', error);
            }
        }

        // Add asset
        function addAsset() {
            const select = document.getElementById('assetSelect');
            const id = select.value;
            if (!id) return;
            
            if (portfolio.find(p => p.id === id)) {
                alert('Asset already in portfolio!');
                return;
            }
            
            portfolio.push({ id, allocation: 20 });
            select.value = '';
            renderAssetList();
        }

        // Remove asset
        function removeAsset(id) {
            portfolio = portfolio.filter(p => p.id !== id);
            renderAssetList();
        }

        // Update allocation
        function updateAllocation(id, value) {
            const asset = portfolio.find(p => p.id === id);
            if (asset) {
                asset.allocation = parseFloat(value) || 0;
            }
        }

        // Render asset list
        function renderAssetList() {
            const list = document.getElementById('assetList');
            
            if (portfolio.length === 0) {
                list.innerHTML = '<div style="color: #666; text-align: center; padding: 1rem;">No assets added. Add assets from the dropdown below.</div>';
                updatePieChart();
                return;
            }
            
            list.innerHTML = portfolio.map(p => {
                const meta = assetMeta[p.id];
                return `
                    <div class="asset-item">
                        <div class="asset-info">
                            <div class="asset-icon" style="background: ${meta.color}20; color: ${meta.color}">${meta.icon}</div>
                            <div>
                                <div class="asset-name">${meta.name}</div>
                                <div class="asset-symbol">${meta.symbol}</div>
                            </div>
                        </div>
                        <div class="asset-allocation">
                            <input type="number" class="allocation-input" value="${p.allocation}" onchange="updateAllocation('${p.id}', this.value)" min="0" max="100">
                            <span>%</span>
                            <button class="remove-btn" onclick="removeAsset('${p.id}')">√ó</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            updatePieChart();
        }

        // Update pie chart
        function updatePieChart() {
            const svg = document.querySelector('#pieChart svg');
            const legend = document.getElementById('pieLegend');
            
            if (portfolio.length === 0) {
                svg.innerHTML = '<circle cx="50" cy="50" r="40" fill="#2a2a4a"/>';
                legend.innerHTML = '<div style="color: #666; text-align: center;">No assets</div>';
                return;
            }
            
            let cumulativePercent = 0;
            let paths = '';
            let legendItems = '';
            
            portfolio.forEach(p => {
                const meta = assetMeta[p.id];
                const percent = p.allocation / 100;
                
                const startX = 50 + 40 * Math.cos(2 * Math.PI * cumulativePercent - Math.PI / 2);
                const startY = 50 + 40 * Math.sin(2 * Math.PI * cumulativePercent - Math.PI / 2);
                cumulativePercent += percent;
                const endX = 50 + 40 * Math.cos(2 * Math.PI * cumulativePercent - Math.PI / 2);
                const endY = 50 + 40 * Math.sin(2 * Math.PI * cumulativePercent - Math.PI / 2);
                
                const largeArcFlag = percent > 0.5 ? 1 : 0;
                
                if (percent > 0) {
                    if (percent >= 1) {
                        paths += `<circle cx="50" cy="50" r="40" fill="${meta.color}"/>`;
                    } else {
                        paths += `<path d="M 50 50 L ${startX} ${startY} A 40 40 0 ${largeArcFlag} 1 ${endX} ${endY} Z" fill="${meta.color}"/>`;
                    }
                }
                
                legendItems += `
                    <div class="legend-item">
                        <div class="legend-color" style="background: ${meta.color}"></div>
                        <span>${meta.symbol}: ${p.allocation}%</span>
                    </div>
                `;
            });
            
            svg.innerHTML = paths;
            legend.innerHTML = legendItems;
        }

        // Analyze risk
        async function analyzeRisk() {
            if (portfolio.length === 0) {
                alert('Please add at least one asset to your portfolio!');
                return;
            }
            
            const totalAllocation = portfolio.reduce((sum, p) => sum + p.allocation, 0);
            if (Math.abs(totalAllocation - 100) > 0.1) {
                alert(`Total allocation must equal 100%. Current: ${totalAllocation}%`);
                return;
            }
            
            const btn = document.getElementById('analyzeBtn');
            btn.disabled = true;
            btn.innerHTML = '<span>‚è≥</span> Analyzing...';
            
            await fetchPrices();
            
            const portfolioValue = parseFloat(document.getElementById('portfolioValue').value) || 10000;
            const timeHorizon = parseInt(document.getElementById('timeHorizon').value);
            const confidence = parseFloat(document.getElementById('confidenceLevel').value);
            
            // Calculate weighted volatility
            let weightedVolatility = 0;
            portfolio.forEach(p => {
                const meta = assetMeta[p.id];
                weightedVolatility += (p.allocation / 100) * meta.volatility;
            });
            
            // Time-adjusted volatility
            const timeAdjustedVol = weightedVolatility * Math.sqrt(timeHorizon / 365);
            
            // Z-scores for confidence levels
            const zScores = { 0.90: 1.28, 0.95: 1.65, 0.99: 2.33 };
            const zScore = zScores[confidence];
            
            // Value at Risk
            const varPercent = timeAdjustedVol * zScore;
            const varValue = portfolioValue * varPercent;
            
            // CVaR (Expected Shortfall) - approximate as 1.25x VaR
            const cvarValue = varValue * 1.25;
            
            // Sharpe Ratio (assuming risk-free rate of 4%)
            const riskFreeRate = 0.04;
            const expectedReturn = 0.10 + (weightedVolatility * 0.15); // Higher vol = higher expected return
            const sharpeRatio = (expectedReturn - riskFreeRate) / weightedVolatility;
            
            // Max Drawdown estimate based on volatility
            const maxDrawdown = Math.min(0.95, weightedVolatility * 1.5);
            
            // Portfolio Beta (relative to overall market)
            const cryptoWeight = portfolio.filter(p => !p.id.startsWith('stock-') && !['tether', 'usd-coin'].includes(p.id))
                .reduce((sum, p) => sum + p.allocation, 0) / 100;
            const beta = 0.3 + cryptoWeight * 1.5;
            
            // Skewness and Kurtosis (crypto tends to have negative skew and high kurtosis)
            const skewness = -0.2 - cryptoWeight * 0.5;
            const kurtosis = 3 + cryptoWeight * 4;
            
            // Risk Score (0-100)
            const riskScore = Math.min(100, Math.round(weightedVolatility * 100));
            
            // Update UI
            updateRiskGauge(riskScore);
            
            document.getElementById('varValue').textContent = '$' + varValue.toLocaleString('en-US', { maximumFractionDigits: 0 });
            document.getElementById('varPercent').textContent = (varPercent * 100).toFixed(1) + '% of portfolio';
            
            document.getElementById('sharpeValue').textContent = sharpeRatio.toFixed(2);
            const sharpeRating = document.getElementById('sharpeRating');
            if (sharpeRatio >= 1) {
                sharpeRating.textContent = '‚úÖ Good';
                sharpeRating.className = 'metric-change positive';
            } else if (sharpeRatio >= 0.5) {
                sharpeRating.textContent = '‚ö†Ô∏è Moderate';
                sharpeRating.className = 'metric-change';
            } else {
                sharpeRating.textContent = '‚ùå Poor';
                sharpeRating.className = 'metric-change negative';
            }
            
            document.getElementById('volatilityValue').textContent = (weightedVolatility * 100).toFixed(1) + '%';
            const volRating = document.getElementById('volatilityRating');
            if (weightedVolatility < 0.25) {
                volRating.textContent = 'üü¢ Low';
                volRating.className = 'metric-change positive';
            } else if (weightedVolatility < 0.50) {
                volRating.textContent = 'üü° Moderate';
                volRating.className = 'metric-change';
            } else {
                volRating.textContent = 'üî¥ High';
                volRating.className = 'metric-change negative';
            }
            
            document.getElementById('drawdownValue').textContent = (maxDrawdown * 100).toFixed(1) + '%';
            document.getElementById('drawdownRating').textContent = 'Potential loss in crash';
            
            document.getElementById('cvarValue').textContent = '$' + cvarValue.toLocaleString('en-US', { maximumFractionDigits: 0 });
            document.getElementById('betaValue').textContent = beta.toFixed(2);
            document.getElementById('skewnessValue').textContent = skewness.toFixed(2);
            document.getElementById('kurtosisValue').textContent = kurtosis.toFixed(2);
            document.getElementById('recoveryValue').textContent = Math.round(maxDrawdown * 365 / 2) + ' days';
            
            // Generate drawdown bars
            generateDrawdownChart(weightedVolatility);
            
            // Generate AI insights
            generateAIInsights(riskScore, sharpeRatio, weightedVolatility, maxDrawdown, portfolio);
            
            btn.disabled = false;
            btn.innerHTML = '<span>üîç</span> Analyze Portfolio Risk';
        }

        function updateRiskGauge(score) {
            const needle = document.getElementById('riskNeedle');
            const rotation = -90 + (score / 100) * 180;
            needle.setAttribute('transform', `rotate(${rotation}, 100, 100)`);
            
            const gaugeFill = document.getElementById('riskGaugeFill');
            const offset = 251 - (score / 100) * 251;
            gaugeFill.style.strokeDashoffset = offset;
            
            document.getElementById('riskScoreValue').textContent = score;
            
            const label = document.getElementById('riskScoreLabel');
            if (score < 30) {
                label.textContent = 'üü¢ Low Risk';
                label.style.color = '#22c55e';
            } else if (score < 50) {
                label.textContent = 'üü° Moderate Risk';
                label.style.color = '#fbbf24';
            } else if (score < 70) {
                label.textContent = 'üü† High Risk';
                label.style.color = '#f97316';
            } else {
                label.textContent = 'üî¥ Very High Risk';
                label.style.color = '#ef4444';
            }
        }

        function generateDrawdownChart(volatility) {
            const container = document.getElementById('drawdownBars');
            let bars = '';
            
            for (let i = 0; i < 30; i++) {
                const randomDrawdown = Math.random() * volatility * 50;
                const height = 10 + randomDrawdown;
                const color = randomDrawdown < 15 ? '#22c55e' : randomDrawdown < 30 ? '#fbbf24' : '#ef4444';
                bars += `<div class="drawdown-bar" style="height: ${height}%; background: ${color};" title="-${randomDrawdown.toFixed(1)}%"></div>`;
            }
            
            container.innerHTML = bars;
        }

        function generateAIInsights(riskScore, sharpe, volatility, drawdown, portfolio) {
            const recommendations = [];
            let content = '';
            
            if (riskScore >= 70) {
                content = `<strong>‚ö†Ô∏è High Risk Alert:</strong> Your portfolio has a risk score of ${riskScore}/100, indicating significant volatility exposure. With ${(volatility * 100).toFixed(1)}% annualized volatility, you could see large daily swings. `;
                recommendations.push({ text: 'Consider reducing crypto allocation', class: 'danger' });
                recommendations.push({ text: 'Add stable assets (USDT, bonds)', class: 'warning' });
            } else if (riskScore >= 40) {
                content = `<strong>üìä Moderate Risk Profile:</strong> Your portfolio has a balanced risk score of ${riskScore}/100. Volatility of ${(volatility * 100).toFixed(1)}% is typical for mixed portfolios. `;
                recommendations.push({ text: 'Good balance maintained', class: 'success' });
                recommendations.push({ text: 'Monitor market conditions', class: 'warning' });
            } else {
                content = `<strong>‚úÖ Conservative Portfolio:</strong> Your risk score of ${riskScore}/100 indicates a defensive stance. Low volatility of ${(volatility * 100).toFixed(1)}% means smaller swings but potentially lower returns. `;
                recommendations.push({ text: 'Well protected against crashes', class: 'success' });
                recommendations.push({ text: 'May underperform in bull markets', class: 'warning' });
            }
            
            if (sharpe < 0.5) {
                content += `The Sharpe ratio of ${sharpe.toFixed(2)} suggests you're not being compensated well for the risk taken. `;
                recommendations.push({ text: 'Low risk-adjusted returns', class: 'danger' });
            } else if (sharpe >= 1) {
                content += `Sharpe ratio of ${sharpe.toFixed(2)} indicates excellent risk-adjusted returns. `;
                recommendations.push({ text: 'Strong Sharpe ratio', class: 'success' });
            }
            
            content += `Maximum potential drawdown is estimated at ${(drawdown * 100).toFixed(1)}% - ensure you can handle this level of loss emotionally and financially.`;
            
            document.getElementById('aiContent').innerHTML = content;
            document.getElementById('aiRecommendations').innerHTML = recommendations.map(r => 
                `<span class="ai-rec ${r.class}">${r.text}</span>`
            ).join('');
        }

        // Initialize
        renderAssetList();
    </script>
</body>
</html>
